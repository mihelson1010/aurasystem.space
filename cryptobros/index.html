<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CRYPTOBROS</title>
  <style>
    :root {
      --light-bg: #f8f9fa;
      --light-card: #ffffff;
      --text-dark: #1a1a1a;
      --neon: #00f3ff;
      --pink: #ff2a6d;
      --accent: #4a90e2;
      --yellow: #ffcc00;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: var(--light-bg);
      color: var(--text-dark);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .header {
      position: sticky;
      top: 0;
      background: rgba(255, 255, 255, 0.95);
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      backdrop-filter: blur(10px);
      z-index: 10;
      border-bottom: 1px solid var(--neon);
    }

    .logo {
      font-size: 1.8rem;
      background: linear-gradient(90deg, var(--neon), var(--pink));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 800;
      cursor: pointer;
    }

    .header-right { display: flex; gap: 12px; align-items: center; }
    .lang-label {
      font-size: 0.9rem;
      padding: 6px 12px;
      border-radius: 20px;
      background: rgba(0, 243, 255, 0.1);
      color: var(--neon);
      cursor: pointer;
      border: 1px solid var(--neon);
      user-select: none;
    }
    .lang-dropdown {
      display: none;
      position: absolute;
      top: 50px;
      right: 20px;
      background: white;
      border: 1px solid var(--neon);
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 100;
    }
    .lang-item {
      padding: 8px 16px;
      cursor: pointer;
    }
    .lang-item:hover { background: rgba(0, 243, 255, 0.1); }

    .page { display: none; padding: 0; }
    .active { display: block !important; }

    /* Главная */
    .hero {
      text-align: center;
      padding: 100px 20px 60px;
      background: linear-gradient(135deg, #fff2cc, #ffe680);
      position: relative;
    }
    .hero-logo {
      width: 300px;
      height: auto;
      margin: 0 auto 30px;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1));
    }
    .hero h1 {
      font-size: 3.8rem;
      margin: 20px 0;
      background: linear-gradient(90deg, var(--neon), var(--pink));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .hero p {
      color: #555;
      font-size: 1.2rem;
      max-width: 700px;
      margin: 0 auto 30px;
    }
    .btn {
      padding: 14px 32px;
      border-radius: 50px;
      font-size: 1.1rem;
      font-weight: bold;
      color: black;
      background: var(--neon);
      border: none;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(0, 243, 255, 0.5); }

    /* Манифест */
    .manifest-container {
      max-width: 800px;
      margin: 60px auto;
      padding: 30px;
      background: white;
      border: 2px solid var(--neon);
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.05);
      position: relative;
    }
    .manifest-title {
      text-align: center;
      color: var(--neon);
      font-size: 2rem;
      margin-bottom: 30px;
      text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
    }
    .manifest-list {
      list-style: none;
      padding: 0;
      margin: 30px 0;
    }
    .manifest-list li {
      margin: 10px 0;
      padding: 12px 20px;
      border-left: 4px solid var(--pink);
      background: rgba(255, 255, 255, 0.7);
      border-radius: 12px;
      transition: all 0.2s;
    }
    .consent {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 20px 0;
      padding: 15px;
      background: rgba(0, 243, 255, 0.1);
      border-radius: 12px;
    }
    .consent input[type="checkbox"] {
      width: 20px;
      height: 20px;
      accent-color: var(--neon);
    }
    .consent label {
      color: var(--text-dark);
      font-size: 1rem;
    }
    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .btn-confirm {
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: bold;
      color: black;
      background: linear-gradient(90deg, var(--neon), var(--pink));
      border: none;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(0, 243, 255, 0.2);
    }
    .btn-confirm:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(0, 243, 255, 0.4);
    }
    .btn-back {
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: bold;
      color: black;
      background: var(--pink);
      border: none;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(255, 42, 109, 0.2);
    }
    .btn-back:hover {
      background: #ff1a55;
      transform: scale(1.05);
    }
    .btn-promo {
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: bold;
      color: black;
      background: linear-gradient(90deg, var(--accent), var(--yellow));
      border: none;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(74, 144, 226, 0.2);
    }
    .btn-promo:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    }
    .promo-input {
      width: 100%;
      padding: 12px;
      background: rgba(0, 243, 255, 0.1);
      color: var(--text-dark);
      border: 1px solid var(--neon);
      border-radius: 12px;
      font-size: 1rem;
      margin-top: 10px;
      transition: all 0.2s;
    }
    .promo-input:focus {
      outline: none;
      border-color: var(--pink);
      box-shadow: 0 0 10px rgba(255, 42, 109, 0.3);
    }

    /* Профиль */
    .cover {
      height: 300px;
      background: linear-gradient(135deg, #f0f4ff, #ffeef0);
      position: relative;
      border-bottom: 1px solid var(--neon);
    }
    .profile-header {
      position: absolute;
      bottom: 20px;
      left: 20px;
      display: flex;
      align-items: center;
      gap: 20px;
    }
    .profile-avatar {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 2.2rem;
      font-weight: bold;
      border: 4px solid white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      background-size: cover !important;
      background-position: center !important;
    }
    .profile-name { font-size: 2.2rem; font-weight: bold; color: var(--neon); }
    .profile-desc { color: #666; }

    .profile-buttons { padding: 20px; display: flex; gap: 12px; flex-wrap: wrap; }

    .post-box {
      background: var(--light-card);
      padding: 20px;
      margin: 0 20px 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    .post-input {
      width: 100%;
      height: 100px;
      padding: 12px;
      background: #fafafa;
      color: var(--text-dark);
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .post {
      background: var(--light-card);
      border: 1px solid #eee;
      border-radius: 12px;
      padding: 16px;
      margin: 16px 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.03);
    }
    .post-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
    }
    .post-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      background-size: cover;
      background-position: center;
    }
    .post-username { font-weight: bold; color: var(--neon); }
    .post-timestamp { color: #888; font-size: 0.8rem; margin-left: auto; }

    .sections {
      display: flex;
      gap: 20px;
      padding: 0 20px 20px;
      flex-wrap: wrap;
    }
    .section {
      background: var(--light-card);
      padding: 16px;
      border-radius: 12px;
      min-width: 220px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.03);
    }
    .section h4 { color: var(--neon); margin-bottom: 12px; }
    .avatars { display: flex; gap: 10px; flex-wrap: wrap; }
    .avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--accent);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
    }

    /* Footer */
    .footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      text-align: center;
      padding: 14px;
      font-size: 0.95rem;
      background: white;
      border-top: 1px solid var(--neon);
      z-index: 5;
      animation: footerRainbow 4s infinite alternate;
    }
    @keyframes footerRainbow {
      0%   { color: #00f3ff; text-shadow: 0 0 10px rgba(0, 243, 255, 0.7); }
      25%  { color: #ff2a6d; text-shadow: 0 0 10px rgba(255, 42, 109, 0.7); }
      50%  { color: #ffcc00; text-shadow: 0 0 10px rgba(255, 204, 0, 0.7); }
      75%  { color: #7b2cbf; text-shadow: 0 0 10px rgba(123, 44, 191, 0.7); }
      100% { color: #00c897; text-shadow: 0 0 10px rgba(0, 200, 151, 0.7); }
    }
  </style>
</head>
<body>

<div class="header">
  <div class="logo" onclick="goTo('home')">CRYPTOBROS</div>
  <div class="header-right">
    <div class="lang-label" id="langLabel" aria-label="Select language" tabindex="0" role="button">EN</div>
    <div class="lang-dropdown" id="langDropdown">
      <div class="lang-item" data-lang="en">EN</div>
      <div class="lang-item" data-lang="ru">RU</div>
      <div class="lang-item" data-lang="es">ES</div>
      <div class="lang-item" data-lang="fr">FR</div>
      <div class="lang-item" data-lang="zh">中文</div>
      <div class="lang-item" data-lang="ja">日本語</div>
      <div class="lang-item" data-lang="he">עברית</div>
      <div class="lang-item" data-lang="ar">العربية</div>
      <div class="lang-item" data-lang="de">DE</div>
      <div class="lang-item" data-lang="pt">PT</div>
    </div>
  </div>
</div>

<!-- Главная -->
<div id="home" class="page active">
  <div class="hero">
    <img src="/cryptobros/logo-bros.svg" alt="CRYPTOBROS" class="hero-logo">
    <h1>AI TRIBUNAL. ZERO KYC.</h1>
    <p>The first social network where three AIs — Grok, Qwen2, and Phi-3 — debate every token in real time before speaking the truth.</p>
    <button class="btn" onclick="goTo('manifest')">Get Access</button>
  </div>
</div>

<!-- Манифест -->
<div id="manifest" class="page">
  <div class="manifest-container">
    <h2 class="manifest-title">MANIFESTO</h2>
    <ul class="manifest-list">
      <li>Bros in. Noise out.</li>
      <li>No servers. Zero KYC. Only wallet.</li>
      <li>We do not advise buying! We advise not buying!</li>
      <li>Pay 300 AUS to prove you’re real.</li>
      <li>Privacy-native. End-to-end encrypted.</li>
      <li>Full control. No tracking. Ever.</li>
    </ul>
    <div class="consent">
      <input type="checkbox" id="manifest-consent">
      <label for="manifest-consent">I agree with the CRYPTOBROS Manifest</label>
    </div>
    <div class="action-buttons">
      <button id="confirm-btn" class="btn-confirm" disabled>Confirm & Pay 300 AUS</button>
      <button class="btn-back" onclick="goTo('home')">Back</button>
      <button id="promo-btn" class="btn-promo" disabled>Enter Promo Code</button>
    </div>
    <input type="text" id="promo-code" placeholder="AURAFIRE7" class="promo-input" style="display:none;">
  </div>
</div>

<!-- Профиль -->
<div id="profile" class="page">
  <div class="cover">
    <div class="profile-header">
      <div class="profile-avatar" id="profile-avatar">A</div>
      <div>
        <div class="profile-name" id="profile-name">Anonymous</div>
        <div class="profile-desc">CryptoBros user since 2025</div>
      </div>
    </div>
  </div>

  <div class="profile-buttons">
    <label class="btn" style="cursor:pointer;">
      <input type="file" id="avatar-upload" accept="image/*" style="display:none;" onchange="uploadAvatar(this)">
      Change Avatar
    </label>
    <button class="btn" onclick="editName()">Change Name</button>
    <button class="btn" onclick="showAskModal()">Ask The Michelson Triad</button>
  </div>

  <div style="text-align:center; margin:20px;">
    <button class="btn" onclick="setPassphrase()" id="passphrase-btn">Set Passphrase</button>
    <button class="btn" onclick="logout()" style="background:#ff4444; margin-left:10px;">Logout</button>
    <p id="passphrase-status" style="color:#666; font-size:0.9rem; margin-top:8px;"></p>
  </div>

  <div class="post-box">
    <textarea class="post-input" id="post-input" placeholder="What's on your mind?"></textarea>
    <button class="btn" onclick="createPost()">Post</button>
  </div>

  <div id="user-posts-container"></div>
</div>

<div class="footer">Produced by Mihelson © 2025</div>

<script>
  const WALLET_ADDRESS = '5R8wHTuWuhxGE6qUHbPh4RZatKBAvxJKpmLAdA2GbzPL';

  function sanitize(str) {
    if (!str) return '';
    return String(str).replace(/[&<>"']/g, '');
  }

  function goTo(pageId) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(pageId)?.classList.add('active');
    window.location.hash = pageId;
    localStorage.setItem('lastPage', pageId);
  }

  window.addEventListener('popstate', () => {
    const hash = window.location.hash.replace('#', '') || 'home';
    goTo(hash);
  });

  // a11y: клавиатура для языка
  document.getElementById('langLabel').addEventListener('keydown', e => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      const d = document.getElementById('langDropdown');
      d.style.display = d.style.display === 'block' ? 'none' : 'block';
    }
  });

  // === ФИНАЛЬНАЯ ИНИЦИАЛИЗАЦИЯ: ГОСТЬ → ГЛАВНАЯ ===
  window.addEventListener('load', () => {
    // Проверка passphrase при старте
    const passHash = localStorage.getItem('cryptobros_pass_hash');
    if (passHash) {
      const pass = prompt('Enter passphrase to unlock:');
      if (!pass || btoa(pass) !== passHash) {
        alert('Access denied');
        localStorage.clear();
        location.reload();
        return;
      }
    }

    const access = localStorage.getItem('cryptobros_access');
    const hash = window.location.hash.replace('#', '');

    // Если есть хеш — идём туда
    if (hash) {
      if (access === 'granted' || ['home', 'manifest'].includes(hash)) {
        goTo(hash);
      } else {
        goTo('home');
      }
    } else {
      // НЕТ хеша → ВСЕГДА главная
      goTo('home');
    }

    updateProfileUI();
    renderUserPosts();
  });

  // Языки
  document.getElementById('langLabel').addEventListener('click', () => {
    const d = document.getElementById('langDropdown');
    d.style.display = d.style.display === 'block' ? 'none' : 'block';
  });
  document.querySelectorAll('.lang-item').forEach(item => {
    item.addEventListener('click', () => {
      currentLang = item.dataset.lang;
      document.getElementById('langLabel').textContent = item.dataset.lang.toUpperCase();
      document.getElementById('langDropdown').style.display = 'none';
    });
  });

  // Манифест
  document.getElementById('manifest-consent')?.addEventListener('change', function() {
    const c = document.getElementById('confirm-btn');
    const p = document.getElementById('promo-btn');
    const i = document.getElementById('promo-code');
    if (this.checked) {
      c.disabled = false;
      p.disabled = false;
      i.style.display = 'block';
    } else {
      c.disabled = true;
      p.disabled = true;
      i.style.display = 'none';
    }
  });

  document.getElementById('confirm-btn')?.addEventListener('click', () => {
    if (!document.getElementById('manifest-consent').checked) return;
    alert(`Send 300 AUS to:\n${WALLET_ADDRESS}`);
    localStorage.setItem('cryptobros_access', 'granted');
    goTo('profile');
  });

  document.getElementById('promo-btn')?.addEventListener('click', () => {
    if (!document.getElementById('manifest-consent').checked) return;
    const code = document.getElementById('promo-code').value.trim();
    if (code === 'AURAFIRE7') {
      localStorage.setItem('cryptobros_access', 'granted');
      alert('Welcome to CryptoBros!');
      goTo('profile');
    } else {
      alert('Invalid promo code.');
    }
  });

  // === АВАТАР ===
  function uploadAvatar(input) {
    const file = input.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = e => {
      const imgData = e.target.result;
      localStorage.setItem('cryptobros_avatar_img', imgData);
      updateProfileUI();
    };
    reader.readAsDataURL(file);
  }

  // === ИМЯ ===
  function editName() {
    const name = prompt('Display name:', localStorage.getItem('cryptobros_name') || '');
    if (name) {
      localStorage.setItem('cryptobros_name', sanitize(name));
      updateProfileUI();
    }
  }

  // === ПРОФИЛЬ UI ===
  function updateProfileUI() {
    const name = sanitize(localStorage.getItem('cryptobros_name') || 'Anonymous');
    const avatarImg = localStorage.getItem('cryptobros_avatar_img');

    document.getElementById('profile-name').textContent = name;

    const avatarEl = document.getElementById('profile-avatar');
    if (avatarImg) {
      avatarEl.style.backgroundImage = `url(${avatarImg})`;
      avatarEl.style.background = 'none';
      avatarEl.textContent = '';
    } else {
      avatarEl.style.backgroundImage = 'none';
      avatarEl.style.background = 'var(--pink)';
      avatarEl.textContent = name[0].toUpperCase();
    }
  }

  // === ПОСТЫ ===
  function createPost() {
    const text = sanitize(document.getElementById('post-input').value.trim());
    if (!text) return alert('Write something!');
    const posts = JSON.parse(localStorage.getItem('cryptobros_posts') || '[]');
    posts.push({ id: Date.now(), text, timestamp: new Date().toLocaleString() });
    localStorage.setItem('cryptobros_posts', JSON.stringify(posts));
    renderUserPosts();
    document.getElementById('post-input').value = '';
  }

  function renderUserPosts() {
    const container = document.getElementById('user-posts-container');
    const posts = JSON.parse(localStorage.getItem('cryptobros_posts') || '[]');
    container.innerHTML = '';
    posts.reverse().forEach(p => {
      const post = document.createElement('div');
      post.className = 'post';
      const header = document.createElement('div');
      header.className = 'post-header';
      const avatar = document.createElement('div');
      avatar.className = 'post-avatar';
      const avatarImg = localStorage.getItem('cryptobros_avatar_img');
      if (avatarImg) {
        avatar.style.backgroundImage = `url(${avatarImg})`;
        avatar.style.background = 'none';
        avatar.textContent = '';
      } else {
        avatar.style.background = 'var(--pink)';
        avatar.textContent = (localStorage.getItem('cryptobros_name') || 'A')[0].toUpperCase();
      }
      const username = document.createElement('div');
      username.className = 'post-username';
      username.textContent = sanitize(localStorage.getItem('cryptobros_name') || 'Anonymous');
      const time = document.createElement('div');
      time.className = 'post-timestamp';
      time.textContent = p.timestamp;
      const content = document.createElement('div');
      content.textContent = p.text;
      header.appendChild(avatar);
      header.appendChild(username);
      header.appendChild(time);
      post.appendChild(header);
      post.appendChild(content);
      container.appendChild(post);
    });
  }

  // === МОДАЛКА ===
  let currentModal = null;
  function showAskModal() {
    if (currentModal) return;
    const modal = document.createElement('div');
    modal.id = 'ask-modal';
    modal.innerHTML = `
      <div style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:100; display:flex; align-items:center; justify-content:center;">
        <div style="background:white; padding:24px; border-radius:16px; border:1px solid var(--neon); max-width:600px; width:90%;">
          <h3 style="color:var(--neon); margin-bottom:16px;">Ask The Michelson Triad</h3>
          <textarea id="modal-input" placeholder="e.g. Is $PEPE safe to buy?" style="width:100%; height:100px; padding:12px; background:#fafafa; color:#333; border:1px solid var(--neon); border-radius:8px;"></textarea>
          <div style="margin-top:16px; display:flex; gap:10px;">
            <button class="btn" onclick="submitModalQuestion()">Send</button>
            <button class="btn" style="background:#555; color:white;" onclick="closeModal()">Cancel</button>
          </div>
        </div>
      </div>
    `;
    modal.addEventListener('click', e => {
      if (e.target === modal) closeModal();
    });
    document.body.appendChild(modal);
    currentModal = modal;
  }

  function submitModalQuestion() {
    const q = sanitize(document.getElementById('modal-input').value.trim());
    if (!q) return alert('Enter a question');
    alert(`The Michelson Triad is debating:\n"${q}"`);
    closeModal();

    // Имитация вердикта
    setTimeout(() => {
      const posts = JSON.parse(localStorage.getItem('cryptobros_posts') || '[]');
      posts.push({
        id: Date.now(),
        text: `The Michelson Triad verdict on "${q}":\n\nGrok: Bullish\nQwen2: Risky mint\nPhi-3: LP locked`,
        timestamp: new Date().toLocaleString()
      });
      localStorage.setItem('cryptobros_posts', JSON.stringify(posts));
      renderUserPosts();
    }, 2000);
  }

  function closeModal() {
    if (currentModal) {
      currentModal.remove();
      currentModal = null;
    }
  }

  // === ПАРОЛЬ ===
  function setPassphrase() {
    const current = prompt('Current passphrase (leave empty if none):');
    const storedHash = localStorage.getItem('cryptobros_pass_hash');
    if (storedHash && current && btoa(current) !== storedHash) {
      return alert('Wrong current passphrase!');
    }
    const newPass = prompt('New passphrase (6+ chars):');
    if (!newPass || newPass.length < 6) return alert('Too short!');
    localStorage.setItem('cryptobros_pass_hash', btoa(newPass));
    document.getElementById('passphrase-status').textContent = 'Passphrase set';
    setTimeout(() => document.getElementById('passphrase-status').textContent = '', 3000);
  }

  // === ВЫХОД ===
  function logout() {
    if (confirm('Clear all data and logout?')) {
      localStorage.clear();
      location.reload();
    }
  }
</script>

</body>
</html>
